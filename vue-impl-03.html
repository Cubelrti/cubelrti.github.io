<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue Implementation 03 | Cubelrti&#39;s Blog</title>
    <meta name="description" content="Just playing around">
    
    
    <link rel="preload" href="/assets/css/0.styles.854efcde.css" as="style"><link rel="preload" href="/assets/js/app.f42c0b44.js" as="script"><link rel="preload" href="/assets/js/47.74ba1c55.js" as="script"><link rel="prefetch" href="/assets/js/10.516d8242.js"><link rel="prefetch" href="/assets/js/11.c36dcbcb.js"><link rel="prefetch" href="/assets/js/12.e895b184.js"><link rel="prefetch" href="/assets/js/13.ec7be9a7.js"><link rel="prefetch" href="/assets/js/14.54d29f87.js"><link rel="prefetch" href="/assets/js/15.e407cc44.js"><link rel="prefetch" href="/assets/js/16.db49905b.js"><link rel="prefetch" href="/assets/js/17.736569b1.js"><link rel="prefetch" href="/assets/js/18.1a4266aa.js"><link rel="prefetch" href="/assets/js/19.fab2abb6.js"><link rel="prefetch" href="/assets/js/2.ce88158f.js"><link rel="prefetch" href="/assets/js/20.556d670c.js"><link rel="prefetch" href="/assets/js/21.dc368674.js"><link rel="prefetch" href="/assets/js/22.5febb538.js"><link rel="prefetch" href="/assets/js/23.a8022afa.js"><link rel="prefetch" href="/assets/js/24.12852a72.js"><link rel="prefetch" href="/assets/js/25.5a2f1e7f.js"><link rel="prefetch" href="/assets/js/26.d78beae1.js"><link rel="prefetch" href="/assets/js/27.5cdcdcdf.js"><link rel="prefetch" href="/assets/js/28.4adfd5ba.js"><link rel="prefetch" href="/assets/js/29.a67dfb0b.js"><link rel="prefetch" href="/assets/js/3.2891e7af.js"><link rel="prefetch" href="/assets/js/30.52bb0b17.js"><link rel="prefetch" href="/assets/js/31.bc58c029.js"><link rel="prefetch" href="/assets/js/32.c32f2855.js"><link rel="prefetch" href="/assets/js/33.353142fa.js"><link rel="prefetch" href="/assets/js/34.37af366f.js"><link rel="prefetch" href="/assets/js/35.9bbb247e.js"><link rel="prefetch" href="/assets/js/36.dcd775a7.js"><link rel="prefetch" href="/assets/js/37.7a866a32.js"><link rel="prefetch" href="/assets/js/38.402538ca.js"><link rel="prefetch" href="/assets/js/39.536dee2f.js"><link rel="prefetch" href="/assets/js/4.079b915f.js"><link rel="prefetch" href="/assets/js/40.53a05fc2.js"><link rel="prefetch" href="/assets/js/41.e99a5f5e.js"><link rel="prefetch" href="/assets/js/42.74be2de5.js"><link rel="prefetch" href="/assets/js/43.6a321652.js"><link rel="prefetch" href="/assets/js/44.254475de.js"><link rel="prefetch" href="/assets/js/45.bea33be6.js"><link rel="prefetch" href="/assets/js/46.c1408df5.js"><link rel="prefetch" href="/assets/js/48.91bdc6a5.js"><link rel="prefetch" href="/assets/js/49.b8e75933.js"><link rel="prefetch" href="/assets/js/5.b2c7c0bf.js"><link rel="prefetch" href="/assets/js/50.efea2307.js"><link rel="prefetch" href="/assets/js/51.174b1c37.js"><link rel="prefetch" href="/assets/js/52.fd97caa2.js"><link rel="prefetch" href="/assets/js/6.632b27cc.js"><link rel="prefetch" href="/assets/js/7.b2cab865.js"><link rel="prefetch" href="/assets/js/8.5c5f6195.js"><link rel="prefetch" href="/assets/js/9.ad4020c1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.854efcde.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Cubelrti's Blog</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://cubelrti.github.io/resume/en/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Resume
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://cubelrti.github.io/resume/en/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Resume
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/async-iteration.html" class="sidebar-link">Async Iteration</a></li><li><a href="/bit-manupulation.html" class="sidebar-link">Bit Manupulation</a></li><li><a href="/css-framework-think.html" class="sidebar-link">CSS Framework Think</a></li><li><a href="/css-scrollbars.html" class="sidebar-link">CSS Scrollbars</a></li><li><a href="/darknet-cv2.html" class="sidebar-link">DarkNet &amp; CV2</a></li><li><a href="/event-emitter.html" class="sidebar-link">Event Emitter</a></li><li><a href="/framework-analysis.html" class="sidebar-link">Framework Analysis</a></li><li><a href="/front-end-design-pattern.html" class="sidebar-link">Front-End Design Patterns</a></li><li><a href="/front-end-interview.html" class="sidebar-link">Front-End Interview</a></li><li><a href="/hairline-css.html" class="sidebar-link">Hairline CSS</a></li><li><a href="/image-orientation.html" class="sidebar-link">Image Orientation</a></li><li><a href="/indexed-db.html" class="sidebar-link">IndexedDB Cheatsheet</a></li><li><a href="/intersection-observer.html" class="sidebar-link">Intersection Observer</a></li><li><a href="/javascript-extend.html" class="sidebar-link">Extend in Javascript</a></li><li><a href="/javascript-trending.html" class="sidebar-link">Javascript Trending</a></li><li><a href="/lambda-functions.html" class="sidebar-link">Lambda Expressions</a></li><li><a href="/lazy-load.html" class="sidebar-link">Lazy Load on Web</a></li><li><a href="/lowdb-101.html" class="sidebar-link">LowDB Code Reading</a></li><li><a href="/material-ripple.html" class="sidebar-link">Material Ripple</a></li><li><a href="/modular-javascript.html" class="sidebar-link">Modular Javascript</a></li><li><a href="/node-reverse-proxy.html" class="sidebar-link">Node Reverse Proxy</a></li><li><a href="/nodejs-data-persistence.html" class="sidebar-link">NodeJS Data Persistence</a></li><li><a href="/npm-security.html" class="sidebar-link">NPM Security</a></li><li><a href="/object-creation.html" class="sidebar-link">Object Prototype Extending</a></li><li><a href="/openapi-cheatsheet.html" class="sidebar-link">OpenAPI Cheatsheet</a></li><li><a href="/overcoming-inituition-in-programming.html" class="sidebar-link">Programming Intuition</a></li><li><a href="/pixijs-101.html" class="sidebar-link">PixiJS 101</a></li><li><a href="/promise-optimization.html" class="sidebar-link">Promise Optimization</a></li><li><a href="/prototype-review.html" class="sidebar-link">Prototype Review</a></li><li><a href="/python-asyncio.html" class="sidebar-link">Python asyncio</a></li><li><a href="/react-fiber.html" class="sidebar-link">React Fiber</a></li><li><a href="/redux-saga.html" class="sidebar-link">Redux Saga</a></li><li><a href="/rust-101.html" class="sidebar-link">Rust 101</a></li><li><a href="/throttle-and-debounce.html" class="sidebar-link">Throttle and Debounce</a></li><li><a href="/typescript-and-node.html" class="sidebar-link">TypeScript and Node</a></li><li><a href="/typescript-and-react.html" class="sidebar-link">Typescript and React</a></li><li><a href="/undefined-in-javascript.html" class="sidebar-link">Undefined in Javascript</a></li><li><a href="/v8-async.html" class="sidebar-link">V8 Async</a></li><li><a href="/v8-sorting.html" class="sidebar-link">V8 Sorting</a></li><li><a href="/v8-torque.html" class="sidebar-link">V8 Torque</a></li><li><a href="/variable-length-curring.html" class="sidebar-link">Variable Length Curring</a></li><li><a href="/vue-impl-01.html" class="sidebar-link">Vue Implementation 01</a></li><li><a href="/vue-impl-02.html" class="sidebar-link">Vue Implementation 02</a></li><li><a href="/vue-impl-03.html" class="active sidebar-link">Vue Implementation 03</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue-impl-03.html#vue-s-platform-related-decoration" class="sidebar-link">Vue's Platform Related Decoration</a></li></ul></li><li><a href="/vuex-typescript.html" class="sidebar-link">Vuex Typescript</a></li><li><a href="/webrtc-practice.html" class="sidebar-link">WebRTC Practice</a></li><li><a href="/websocket-practice.html" class="sidebar-link">Websocket Practice</a></li><li><a href="/webworker-caveats.html" class="sidebar-link">WebWorker Caveats</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="vue-implementation-03"><a href="#vue-implementation-03" aria-hidden="true" class="header-anchor">#</a> Vue Implementation 03</h1> <h2 id="vue-s-platform-related-decoration"><a href="#vue-s-platform-related-decoration" aria-hidden="true" class="header-anchor">#</a> Vue's Platform Related Decoration</h2> <p>Now, we made clear about the constructor of <code>Vue</code>, which is <code>core/instance/index.js</code> and <code>core/index.js</code>. The former one is the <strong>definition</strong> of the constructor of <code>Vue</code>. The latter one is to define <strong>global APIs</strong>, which is static functions and properties to <code>Vue</code>. These two files have something in common: They are both located in <code>core</code>. We has descriped the directory when we introducing <code>Vue</code>. Files stored in <code>core</code> is platform-unrelated code. Therefore, <code>core/instance/index.js</code> and <code>core/index.js</code> are both decorating core <code>Vue</code> parts and they are both <strong>platform-unrelated</strong>.</p> <p>However, <code>Vue</code> is a <strong>multi-platform</strong> project, and it can be ported into Web and Weex. Different platform has different components, directives and some platform-related functions. Thereform, <code>Vue</code> has to be packaged targeting to different platforms. So what we are going to take a look at is <code>platforms/web/runtime/index.js</code>, which is our path to find <strong>Vue's construtor</strong>.</p> <p>Before we are taking dive into this file, we can open <code>platforms</code> folder and we can see there are two sub-directories, which is <code>web</code> and <code>weex</code>. These folders is to pack <code>Vue</code> targeting to different platform. As for our concerning <code>web</code> platform, it is included here as well.</p> <p>Then, we open <code>platform/web/runtime/index.js</code> and look at it. There are a lot <code>import</code> at the beginning of this file, including importing <code>Vue</code> from <code>core/index.js</code>.</p> <p>Below <code>import</code>, there is a piece of code:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// install platform specific utils</span>
Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>mustUseProp <span class="token operator">=</span> mustUseProp
Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>isReservedTag <span class="token operator">=</span> isReservedTag
Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>isReservedAttr <span class="token operator">=</span> isReservedAttr
Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>getTagNamespace <span class="token operator">=</span> getTagNamespace
Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>isUnknownElement <span class="token operator">=</span> isUnknownElement
</code></pre></div><p>Do you remember <code>Vue.config</code>? What it proxying is the object exported by <code>core/config.js</code>. It first looks like this:</p> <div class="language-js extra-class"><pre class="language-js"><code>Vue<span class="token punctuation">.</span>config <span class="token operator">=</span> <span class="token punctuation">{</span>
  optionMergeStrategies<span class="token punctuation">:</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  silent<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  productionTip<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
  devtools<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
  performance<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  errorHandler<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  warnHandler<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  ignoredElements<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  keyCodes<span class="token punctuation">:</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  isReservedTag<span class="token punctuation">:</span> no<span class="token punctuation">,</span>
  isReservedAttr<span class="token punctuation">:</span> no<span class="token punctuation">,</span>
  isUnknownElement<span class="token punctuation">:</span> no<span class="token punctuation">,</span>
  getTagNamespace<span class="token punctuation">:</span> noop<span class="token punctuation">,</span>
  parsePlatformTagName<span class="token punctuation">:</span> identity<span class="token punctuation">,</span>
  mustUseProp<span class="token punctuation">:</span> no<span class="token punctuation">,</span>
  _lifecycleHooks<span class="token punctuation">:</span> <span class="token constant">LIFECYCLE_HOOKS</span>
<span class="token punctuation">}</span>
</code></pre></div><p>We can see, properties of the <code>config</code> object exported by <code>core/config.js</code>, are mostly defined as a initial value. And we can see many comments in <code>core/config.js</code> as below:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * Check if a tag is reserved so that it cannot be registered as a 
 * component. This is platform-dependent and may be overritten.
 */</span>
isReservedTag<span class="token punctuation">:</span> no<span class="token punctuation">,</span>

<span class="token comment">/**
 * Check if an attribute is reserved so that it cannot be used as a component
 * prop. This is platform-dependent and may be overritten.
 */</span>
isReservedAttr<span class="token punctuation">:</span> no<span class="token punctuation">,</span>
</code></pre></div><p><strong>This is platform-dependent and may be overritten.</strong> What it means is that this configuration is platform-dependent. And it is very likely to be overritten. Now, we can go back to this code:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// install platform specific utils</span>
Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>mustUseProp <span class="token operator">=</span> mustUseProp
Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>isReservedTag <span class="token operator">=</span> isReservedTag
Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>isReservedAttr <span class="token operator">=</span> isReservedAttr
Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>getTagNamespace <span class="token operator">=</span> getTagNamespace
Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>isUnknownElement <span class="token operator">=</span> isUnknownElement
</code></pre></div><p>Actually, it is overriding properties of <code>config</code> exported by default. It is commented that it will install platform specific utils. As for their effect, we will discuss later.</p> <p>And there are two lines of code:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// install platform runtime directives &amp; components</span>
<span class="token function">extend</span><span class="token punctuation">(</span>Vue<span class="token punctuation">.</span>options<span class="token punctuation">.</span>directives<span class="token punctuation">,</span> platformDirectives<span class="token punctuation">)</span>
<span class="token function">extend</span><span class="token punctuation">(</span>Vue<span class="token punctuation">.</span>options<span class="token punctuation">.</span>components<span class="token punctuation">,</span> platformComponents<span class="token punctuation">)</span>
</code></pre></div><p>They will install platform runtime directives and components. Do you remember how is <code>Vue.options</code> look like? Before these lines executed, it is something like this:</p> <div class="language-js extra-class"><pre class="language-js"><code>Vue<span class="token punctuation">.</span>options <span class="token operator">=</span> <span class="token punctuation">{</span>
 components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  KeepAlive
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
 directives<span class="token punctuation">:</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 filters<span class="token punctuation">:</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 _base<span class="token punctuation">:</span> Vue
<span class="token punctuation">}</span>
</code></pre></div><p>We have once met <code>extend</code> function. In case you forget that, you can always refer to the appendix for <code>/shared/util.js</code>. So what will it look like after these lines? We need to know what is <code>platformDirectives</code> and <code>platformComponents</code>.</p> <p>According to <code>import</code> at the beginning:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> platformDirectives <span class="token keyword">from</span> <span class="token string">'./directives/index'</span>
<span class="token keyword">import</span> platformComponents <span class="token keyword">from</span> <span class="token string">'./components/index'</span>
</code></pre></div><p>We know that these varible is imported from <code>runtime/directives/index.js</code> and <code>runtime/components/index.js</code>. We open <code>runtime/directives/index.js</code> and:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> model <span class="token keyword">from</span> <span class="token string">'./model'</span>
<span class="token keyword">import</span> show <span class="token keyword">from</span> <span class="token string">'./show'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  model<span class="token punctuation">,</span>
  show
<span class="token punctuation">}</span>
</code></pre></div><p>That is to say that <code>platformDirectives</code> is:</p> <div class="language-js extra-class"><pre class="language-js"><code>platformDirectives <span class="token operator">=</span> <span class="token punctuation">{</span>
  model<span class="token punctuation">,</span>
  show
<span class="token punctuation">}</span>
</code></pre></div><p>Therefore, after <code>extend</code> is executed, <code>Vue.options</code> become:</p> <div class="language-js extra-class"><pre class="language-js"><code>Vue<span class="token punctuation">.</span>options <span class="token operator">=</span> <span class="token punctuation">{</span>
 components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  KeepAlive
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
 directives<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  model<span class="token punctuation">,</span>
  show
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
 filters<span class="token punctuation">:</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 _base<span class="token punctuation">:</span> Vue
<span class="token punctuation">}</span>
</code></pre></div><p><code>runtime/components/index.js</code> is:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Transition <span class="token keyword">from</span> <span class="token string">'./transition'</span>
<span class="token keyword">import</span> TransitionGroup <span class="token keyword">from</span> <span class="token string">'./transition-group'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  Transition<span class="token punctuation">,</span>
  TransitionGroup
<span class="token punctuation">}</span>
</code></pre></div><p>So <code>platformComponents</code> is:</p> <div class="language-js extra-class"><pre class="language-js"><code>platformComponents <span class="token operator">=</span> <span class="token punctuation">{</span>
  Transition<span class="token punctuation">,</span>
  TransitionGroup
<span class="token punctuation">}</span>
</code></pre></div><p>After <code>extend</code>, Vue.options become:</p> <div class="language-js extra-class"><pre class="language-js"><code>Vue<span class="token punctuation">.</span>options <span class="token operator">=</span> <span class="token punctuation">{</span>
 components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  KeepAlive<span class="token punctuation">,</span>
  Transition<span class="token punctuation">,</span>
  TransitionGroup
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
 directives<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  model<span class="token punctuation">,</span>
  show
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
 filters<span class="token punctuation">:</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 _base<span class="token punctuation">:</span> Vue
<span class="token punctuation">}</span>
</code></pre></div><p>So we make clear about these code. It added specific components and directives targeting <code>web</code> platform.</p> <p>Let's get to the remaining code:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// install platform patch function</span>
Vue<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>__patch__ <span class="token operator">=</span> inBrowser <span class="token operator">?</span> patch <span class="token punctuation">:</span> noop

<span class="token comment">// public mount method</span>
Vue<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$mount</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>
  el<span class="token operator">?</span><span class="token punctuation">:</span> string <span class="token operator">|</span> Element<span class="token punctuation">,</span>
  hydrating<span class="token operator">?</span><span class="token punctuation">:</span> boolean
<span class="token punctuation">)</span><span class="token punctuation">:</span> Component <span class="token punctuation">{</span>
  el <span class="token operator">=</span> el <span class="token operator">&amp;&amp;</span> inBrowser <span class="token operator">?</span> <span class="token function">query</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span> <span class="token punctuation">:</span> undefined
  <span class="token keyword">return</span> <span class="token function">mountComponent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> el<span class="token punctuation">,</span> hydrating<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>It added <code>__patch__</code> to <code>Vue.prototype</code>. If you are running in a browser, it will be <code>patch</code> function. Else, it will be a empty function <code>noop</code>. Then, it added <code>$mount</code> function to <code>Vue.prototype</code>. We skip the <code>$mount</code> and its effect.</p> <p>Next, it is the global hook of <code>vue-devtools</code>. It is wrapped in <code>setTimeout</code> and finally exports <code>Vue</code>.</p> <p>So we have read <code>platforms/web/runtime/index.js</code>. Its effect is decorating <code>Vue</code> targeting different platform:</p> <ul><li>It sets <code>Vue.config</code> for platform</li> <li>It mixed two <code>directives</code>: <code>model</code> and <code>show</code></li> <li>It mixed two <code>components</code>: <code>Transition</code> and <code>TransitionGroup</code></li> <li>It added two functions to <code>Vue.prototype</code>: <code>__patch__</code> and <code>$mount</code></li></ul> <p>After this file excuted, <code>Vue.options</code>, <code>Vue.config</code> and <code>Vue.prototype</code> are changed. We can refer these changes in appendix.</p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/vue-impl-02.html" class="prev">
          Vue Implementation 02
        </a></span> <span class="next"><a href="/vuex-typescript.html">
          Vuex Typescript
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.f42c0b44.js" defer></script><script src="/assets/js/47.74ba1c55.js" defer></script>
  </body>
</html>
