(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{180:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),a("p",[a("img",{attrs:{src:"https://img.alicdn.com/tfs/TB1XkgupxjaK1RjSZKzXXXVwXXa-800-450.png",alt:"image | left"}}),t._v("\nç¿»è¯‘è‡ªï¼š"),a("a",{attrs:{href:"https://v8.dev/blog/fast-async",target:"_blank",rel:"noopener noreferrer"}},[t._v("Faster async functions and promises"),a("OutboundLink")],1),t._v("\nJavaScript çš„å¼‚æ­¥è¿‡ç¨‹ä¸€ç›´è¢«è®¤ä¸ºæ˜¯ä¸å¤Ÿå¿«çš„ï¼Œæ›´ç³Ÿç³•çš„æ˜¯ï¼Œåœ¨ NodeJS ç­‰å®æ—¶æ€§è¦æ±‚é«˜çš„åœºæ™¯ä¸‹è°ƒè¯•å ªæ¯”å™©æ¢¦ã€‚ä¸è¿‡ï¼Œè¿™ä¸€åˆ‡æ­£åœ¨æ”¹å˜ï¼Œè¿™ç¯‡æ–‡ç« ä¼šè¯¦ç»†è§£é‡Šæˆ‘ä»¬æ˜¯å¦‚ä½•ä¼˜åŒ– V8 å¼•æ“ï¼ˆä¹Ÿä¼šæ¶‰åŠä¸€äº›å…¶å®ƒå¼•æ“ï¼‰é‡Œçš„ async å‡½æ•°å’Œ promises çš„ï¼Œä»¥åŠä¼´éšç€çš„å¼€å‘ä½“éªŒçš„ä¼˜åŒ–ã€‚\n"),a("strong",[t._v("æ¸©é¦¨æç¤ºï¼š")]),t._v(" è¿™é‡Œæœ‰ä¸ª "),a("a",{attrs:{href:"https://www.youtube.com/watch?v=DFP5DKDQfOc",target:"_blank",rel:"noopener noreferrer"}},[t._v("è§†é¢‘"),a("OutboundLink")],1),t._v("ï¼Œä½ å¯ä»¥ç»“åˆç€æ–‡ç« çœ‹ã€‚")]),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),a("p",[t._v("åœ¨ promises æ­£å¼æˆä¸º JavaScript æ ‡å‡†çš„ä¸€éƒ¨åˆ†ä¹‹å‰ï¼Œå›è°ƒè¢«å¤§é‡ç”¨åœ¨å¼‚æ­¥ç¼–ç¨‹ä¸­ï¼Œä¸‹é¢æ˜¯ä¸ªä¾‹å­ï¼š")]),t._v(" "),t._m(3),a("p",[t._v("ç±»ä¼¼ä»¥ä¸Šæ·±åº¦åµŒå¥—çš„å›è°ƒé€šå¸¸è¢«ç§°ä¸ºã€Œå›è°ƒé»‘æ´ã€ï¼Œå› ä¸ºå®ƒè®©ä»£ç å¯è¯»æ€§å˜å·®ä¸”ä¸æ˜“ç»´æŠ¤ã€‚\nå¹¸è¿åœ°æ˜¯ï¼Œç°åœ¨ promises æˆä¸ºäº† JavaScript è¯­è¨€çš„ä¸€éƒ¨åˆ†ï¼Œä»¥ä¸‹å®ç°äº†è·Ÿä¸Šé¢åŒæ ·çš„åŠŸèƒ½ï¼š")]),t._v(" "),t._m(4),a("p",[t._v("æœ€è¿‘ï¼ŒJavaScript æ”¯æŒäº† "),a("a",{attrs:{href:"https://developers.google.com/web/fundamentals/primers/async-functions",target:"_blank",rel:"noopener noreferrer"}},[t._v("async å‡½æ•°"),a("OutboundLink")],1),t._v("ï¼Œä¸Šé¢çš„å¼‚æ­¥ä»£ç å¯ä»¥å†™æˆåƒä¸‹é¢è¿™æ ·çš„åŒæ­¥çš„ä»£ç ï¼š")]),t._v(" "),t._m(5),a("p",[t._v("å€ŸåŠ© async å‡½æ•°ï¼Œä»£ç å˜å¾—æ›´ç®€æ´ï¼Œä»£ç çš„é€»è¾‘å’Œæ•°æ®æµéƒ½å˜å¾—æ›´å¯æ§ï¼Œå½“ç„¶å…¶å®åº•å±‚å®ç°è¿˜æ˜¯å¼‚æ­¥ã€‚ï¼ˆæ³¨æ„ï¼ŒJavaScript è¿˜æ˜¯å•çº¿ç¨‹æ‰§è¡Œï¼Œasync å‡½æ•°å¹¶ä¸ä¼šå¼€æ–°çš„çº¿ç¨‹ã€‚ï¼‰")]),t._v(" "),t._m(6),t._v(" "),a("p",[t._v("NodeJS é‡Œ "),a("a",{attrs:{href:"https://nodejs.org/api/stream.html#stream_readable_streams",target:"_blank",rel:"noopener noreferrer"}},[t._v("ReadableStreams"),a("OutboundLink")],1),t._v(" ä½œä¸ºå¦ä¸€ç§å½¢å¼çš„å¼‚æ­¥ä¹Ÿç‰¹åˆ«å¸¸è§ï¼Œä¸‹é¢æ˜¯ä¸ªä¾‹å­ï¼š")]),t._v(" "),t._m(7),a("p",[t._v("è¿™æ®µä»£ç æœ‰ä¸€ç‚¹éš¾ç†è§£ï¼šåªèƒ½é€šè¿‡å›è°ƒå»æ‹¿ chunks é‡Œçš„æ•°æ®æµï¼Œè€Œä¸”æ•°æ®æµçš„ç»“æŸä¹Ÿå¿…é¡»åœ¨å›è°ƒé‡Œå¤„ç†ã€‚å¦‚æœä½ æ²¡èƒ½ç†è§£åˆ°å‡½æ•°æ˜¯ç«‹å³ç»“æŸä½†å®é™…å¤„ç†å¿…é¡»åœ¨å›è°ƒé‡Œè¿›è¡Œï¼Œå¯èƒ½å°±ä¼šå¼•å…¥ bugã€‚\nåŒæ ·å¾ˆå¹¸è¿ï¼ŒES2018 ç‰¹æ€§é‡Œå¼•å…¥çš„ä¸€ä¸ªå¾ˆé…·çš„ "),a("a",{attrs:{href:"http://2ality.com/2016/10/asynchronous-iteration.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("async è¿­ä»£å™¨"),a("OutboundLink")],1),t._v(" å¯ä»¥ç®€åŒ–ä¸Šé¢çš„ä»£ç ï¼š")]),t._v(" "),t._m(8),t._m(9),t._v(" "),t._m(10),t._v(" "),a("p",[t._v("ä» V8 v5.5 (Chrome 55 & Node.js 7) åˆ° V8 v6.8 (Chrome 68 & Node.js 10)ï¼Œæˆ‘ä»¬è‡´åŠ›äºå¼‚æ­¥ä»£ç çš„æ€§èƒ½ä¼˜åŒ–ï¼Œç›®å‰çš„æ•ˆæœè¿˜ä¸é”™ï¼Œä½ å¯ä»¥æ”¾å¿ƒåœ°ä½¿ç”¨è¿™äº›æ–°ç‰¹æ€§ã€‚\n"),a("img",{attrs:{src:"https://img.alicdn.com/tfs/TB1LLxkpxTpK1RjSZFMXXbG_VXa-600-371.svg",alt:"image | left"}}),t._v("\nä¸Šé¢çš„æ˜¯ "),a("a",{attrs:{href:"https://github.com/v8/promise-performance-tests/blob/master/lib/doxbee-async.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("doxbee åŸºå‡†æµ‹è¯•"),a("OutboundLink")],1),t._v("ï¼Œç”¨äºååº”é‡åº¦ä½¿ç”¨ promise çš„æ€§èƒ½ï¼Œå›¾ä¸­çºµåæ ‡è¡¨ç¤ºæ‰§è¡Œæ—¶é—´ï¼Œæ‰€ä»¥è¶Šå°è¶Šå¥½ã€‚\nå¦ä¸€æ–¹é¢ï¼Œ"),a("a",{attrs:{href:"https://github.com/v8/promise-performance-tests/blob/master/lib/parallel-async.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("parallel åŸºå‡†æµ‹è¯•"),a("OutboundLink")],1),t._v(" ååº”çš„æ˜¯é‡åº¦ä½¿ç”¨ "),a("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all",target:"_blank",rel:"noopener noreferrer"}},[t._v("Promise.all()"),a("OutboundLink")],1),t._v(" çš„æ€§èƒ½æƒ…å†µï¼Œç»“æœå¦‚ä¸‹ï¼š\n"),a("img",{attrs:{src:"https://img.alicdn.com/tfs/TB1ShxdpwDqK1RjSZSyXXaxEVXa-600-371.svg",alt:"image | left"}}),t._v(" "),a("code",[t._v("Promise.all")]),t._v(" çš„æ€§èƒ½æé«˜äº†__å…«å€__ï¼\nç„¶åï¼Œä¸Šé¢çš„æµ‹è¯•ä»…ä»…æ˜¯å°çš„ DEMO çº§åˆ«çš„æµ‹è¯•ï¼ŒV8 å›¢é˜Ÿæ›´å…³å¿ƒçš„æ˜¯ "),a("a",{attrs:{href:"https://v8.dev/blog/real-world-performance",target:"_blank",rel:"noopener noreferrer"}},[t._v("å®é™…ç”¨æˆ·ä»£ç çš„ä¼˜åŒ–æ•ˆæœ"),a("OutboundLink")],1),t._v("ã€‚\n"),a("img",{attrs:{src:"https://img.alicdn.com/tfs/TB1uqJlpAzoK1RjSZFlXXai4VXa-600-371.svg",alt:"image | left"}}),t._v("\nä¸Šé¢æ˜¯åŸºäºå¸‚åœºä¸Šæµè¡Œçš„ HTTP æ¡†æ¶åšçš„æµ‹è¯•ï¼Œè¿™äº›æ¡†æ¶å¤§é‡ä½¿ç”¨äº† promises å’Œ "),a("code",[t._v("async")]),t._v(" å‡½æ•°ï¼Œè¿™ä¸ªè¡¨å±•ç¤ºçš„æ˜¯æ¯ç§’è¯·æ±‚æ•°ï¼Œæ‰€ä»¥è·Ÿä¹‹å‰çš„è¡¨ä¸ä¸€æ ·ï¼Œè¿™ä¸ªæ˜¯æ•°å€¼è¶Šå¤§è¶Šå¥½ã€‚ä»è¡¨å¯ä»¥çœ‹å‡ºï¼Œä» Node.js 7 (V8 v5.5) åˆ° Node.js 10 (V8 v6.8) æ€§èƒ½æå‡äº†ä¸å°‘ã€‚\næ€§èƒ½æå‡å–å†³äºä»¥ä¸‹ä¸‰ä¸ªå› ç´ ï¼š")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://v8.dev/docs/turbofan",target:"_blank",rel:"noopener noreferrer"}},[t._v("TurboFan"),a("OutboundLink")],1),t._v("ï¼Œæ–°çš„ä¼˜åŒ–ç¼–è¯‘å™¨ ğŸ‰")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://v8.dev/blog/orinoco",target:"_blank",rel:"noopener noreferrer"}},[t._v("Orinoco"),a("OutboundLink")],1),t._v("ï¼Œæ–°çš„åƒåœ¾å›æ”¶å™¨ ğŸš›")]),t._v(" "),a("li",[t._v("ä¸€ä¸ª Node.js 8 çš„ bug å¯¼è‡´ await è·³è¿‡äº†ä¸€äº›å¾® tickï¼ˆmicroticksï¼‰ ğŸ›\nå½“æˆ‘ä»¬åœ¨ "),a("a",{attrs:{href:"https://medium.com/the-node-js-collection/node-js-8-3-0-is-now-available-shipping-with-the-ignition-turbofan-execution-pipeline-aa5875ad3367",target:"_blank",rel:"noopener noreferrer"}},[t._v("Node.js 8"),a("OutboundLink")],1),t._v(" é‡Œ "),a("a",{attrs:{href:"https://v8.dev/blog/launching-ignition-and-turbofan",target:"_blank",rel:"noopener noreferrer"}},[t._v("å¯ç”¨ TurboFan"),a("OutboundLink")],1),t._v(" çš„åï¼Œæ€§èƒ½å¾—åˆ°äº†å·¨å¤§çš„æå‡ã€‚\nåŒæ—¶æˆ‘ä»¬å¼•å…¥äº†ä¸€ä¸ªæ–°çš„åƒåœ¾å›æ”¶å™¨ï¼Œå«ä½œ Orinocoï¼Œå®ƒæŠŠåƒåœ¾å›æ”¶ä»ä¸»çº¿ç¨‹ä¸­ç§»èµ°ï¼Œå› æ­¤å¯¹è¯·æ±‚å“åº”é€Ÿåº¦æå‡æœ‰å¾ˆå¤§å¸®åŠ©ã€‚\næœ€åï¼ŒNode.js 8 ä¸­å¼•å…¥äº†ä¸€ä¸ª bug åœ¨æŸäº›æ—¶å€™ä¼šè®© "),a("code",[t._v("await")]),t._v(" è·³è¿‡ä¸€äº›å¾® tickï¼Œè¿™åè€Œè®©æ€§èƒ½å˜å¥½äº†ã€‚è¿™ä¸ª bug æ˜¯å› ä¸ºæ— æ„ä¸­è¿åäº†è§„èŒƒå¯¼è‡´çš„ï¼Œä½†æ˜¯å´ç»™äº†æˆ‘ä»¬ä¼˜åŒ–çš„ä¸€äº›æ€è·¯ã€‚è¿™é‡Œæˆ‘ä»¬ç¨å¾®è§£é‡Šä¸‹ï¼š")])]),t._v(" "),t._m(11),t._m(12),t._v(" "),t._m(13),t._v(" "),a("p",[t._v("ä»æŸå±‚é¢ä¸Šæ¥è¯´ï¼ŒJavaScript é‡Œå­˜åœ¨ä»»åŠ¡å’Œå¾®ä»»åŠ¡ã€‚ä»»åŠ¡å¤„ç† I/O å’Œè®¡æ—¶å™¨ç­‰äº‹ä»¶ï¼Œä¸€æ¬¡åªå¤„ç†ä¸€ä¸ªã€‚å¾®ä»»åŠ¡æ˜¯ä¸ºäº† "),a("code",[t._v("async")]),t._v("/"),a("code",[t._v("await")]),t._v(" å’Œ promise çš„å»¶è¿Ÿæ‰§è¡Œè®¾è®¡çš„ï¼Œæ¯æ¬¡ä»»åŠ¡æœ€åæ‰§è¡Œã€‚åœ¨è¿”å›äº‹ä»¶å¾ªç¯ï¼ˆevent loopï¼‰å‰ï¼Œå¾®ä»»åŠ¡çš„é˜Ÿåˆ—ä¼šè¢«æ¸…ç©ºã€‚\n"),a("img",{attrs:{src:"https://img.alicdn.com/tfs/TB1IXhnpxTpK1RjSZFKXXa2wXXa-832-286.svg",alt:"image | left"}}),t._v("\nå¯ä»¥é€šè¿‡ Jake Archibald çš„ "),a("a",{attrs:{href:"https://jakearchibald.com/2015/tasks-microtasks-queues-and-schedules/",target:"_blank",rel:"noopener noreferrer"}},[t._v("tasks, microtasks, queues, and schedules in the browser"),a("OutboundLink")],1),t._v(" äº†è§£æ›´å¤šã€‚Node.js é‡Œä»»åŠ¡æ¨¡å‹ä¸æ­¤éå¸¸ç±»ä¼¼ã€‚")]),t._v(" "),t._m(14),t._v(" "),a("p",[t._v("æ ¹æ® MDNï¼Œasync å‡½æ•°æ˜¯ä¸€ä¸ªé€šè¿‡å¼‚æ­¥æ‰§è¡Œå¹¶éšå¼è¿”å› promise ä½œä¸ºç»“æœçš„å‡½æ•°ã€‚ä»å¼€å‘è€…è§’åº¦çœ‹ï¼Œasync å‡½æ•°è®©å¼‚æ­¥ä»£ç çœ‹èµ·æ¥åƒåŒæ­¥ä»£ç ã€‚\nä¸€ä¸ªæœ€ç®€å•çš„ async å‡½æ•°ï¼š")]),t._v(" "),t._m(15),a("p",[t._v("å‡½æ•°æ‰§è¡Œåä¼šè¿”å›ä¸€ä¸ª promiseï¼Œä½ å¯ä»¥åƒä½¿ç”¨å…¶å®ƒ promise ä¸€æ ·ç”¨å…¶è¿”å›çš„å€¼ã€‚")]),t._v(" "),t._m(16),t._m(17),t._v(" "),t._m(18),t._m(19),t._v(" "),t._m(20),t._m(21),t._v(" "),t._m(22),t._m(23),t._v(" "),t._m(24),a("p",[t._v("æ›´æœ‰è¶£çš„æ˜¯ï¼Œ"),a("code",[t._v("await")]),t._v(" åå¯ä»¥è·Ÿä»»ä½• "),a("a",{attrs:{href:"https://promisesaplus.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("â€œthenableâ€"),a("OutboundLink")],1),t._v("ï¼Œä¾‹å¦‚ä»»ä½•å«æœ‰ "),a("code",[t._v("then")]),t._v(" æ–¹æ³•çš„å¯¹è±¡ï¼Œå°±ç®—ä¸æ˜¯ promise éƒ½å¯ä»¥ã€‚å› æ­¤ä½ å¯ä»¥å®ç°ä¸€ä¸ªæœ‰æ„æ€çš„ ç±»æ¥è®°å½•æ‰§è¡Œæ—¶é—´çš„æ¶ˆè€—ï¼š")]),t._v(" "),t._m(25),a("p",[t._v("ä¸€èµ·æ¥çœ‹çœ‹ V8 "),a("a",{attrs:{href:"https://tc39.github.io/ecma262/#await",target:"_blank",rel:"noopener noreferrer"}},[t._v("è§„èŒƒ"),a("OutboundLink")],1),t._v(" é‡Œæ˜¯å¦‚ä½•å¤„ç† "),a("code",[t._v("await")]),t._v(" çš„ã€‚ä¸‹é¢æ˜¯å¾ˆç®€å•çš„ async å‡½æ•° "),a("code",[t._v("foo")]),t._v("ï¼š")]),t._v(" "),t._m(26),t._m(27),t._v(" "),t._m(28),t._v(" "),t._m(29),t._v(" "),a("ol",[t._m(30),t._v(" "),a("li",[t._v("ç»‘å®šå¤„ç†å‡½æ•°ç”¨äºåæœŸæ¢å¤ã€‚")]),t._v(" "),a("li",[t._v("æš‚åœ async å‡½æ•°å¹¶è¿”å› "),a("code",[t._v("implicit_promise")]),t._v(" ç»™æ‰ç”¨è€…ã€‚\næˆ‘ä»¬ä¸€æ­¥æ­¥æ¥çœ‹ï¼Œå‡è®¾ "),a("code",[t._v("await")]),t._v(" åæ˜¯ä¸€ä¸ª promiseï¼Œä¸”æœ€ç»ˆå·²å®ŒæˆçŠ¶æ€çš„å€¼æ˜¯ "),a("code",[t._v("42")]),t._v("ã€‚ç„¶åï¼Œå¼•æ“ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ "),a("code",[t._v("promise")]),t._v(" å¹¶ä¸”æŠŠ "),a("code",[t._v("await")]),t._v(" åçš„å€¼ä½œä¸º resolve çš„å€¼ã€‚å€ŸåŠ©æ ‡å‡†é‡Œçš„ "),a("a",{attrs:{href:"https://tc39.github.io/ecma262/#sec-promiseresolvethenablejob",target:"_blank",rel:"noopener noreferrer"}},[t._v("PromiseResolveThenableJob"),a("OutboundLink")],1),t._v(" è¿™äº› promise ä¼šè¢«æ”¾åˆ°ä¸‹ä¸ªå‘¨æœŸæ‰§è¡Œã€‚\n"),a("img",{attrs:{src:"https://img.alicdn.com/tfs/TB1RBXqppzqK1RjSZFCXXbbxVXa-813-542.svg",alt:"image | left"}}),t._v("\nç„¶åï¼Œå¼•æ“åˆ›å»ºäº†å¦ä¸€ä¸ªå«åš "),a("code",[t._v("throwaway")]),t._v(" çš„ promiseã€‚ä¹‹æ‰€ä»¥å«è¿™ä¸ªåå­—ï¼Œå› ä¸ºæ²¡æœ‰å…¶å®ƒä¸œè¥¿é“¾è¿‡å®ƒï¼Œä»…ä»…æ˜¯å¼•æ“å†…éƒ¨ç”¨çš„ã€‚"),a("code",[t._v("throwaway")]),t._v(" promise ä¼šé“¾åˆ°å«æœ‰æ¢å¤å¤„ç†å‡½æ•°çš„ "),a("code",[t._v("promise")]),t._v(" ä¸Šã€‚è¿™é‡Œ "),a("code",[t._v("performPromiseThen")]),t._v(" æ“ä½œå…¶å®å†…éƒ¨å°±æ˜¯ "),a("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/then",target:"_blank",rel:"noopener noreferrer"}},[t._v("Promise.prototype.then()"),a("OutboundLink")],1),t._v("ã€‚æœ€ç»ˆï¼Œè¯¥ async å‡½æ•°ä¼šæš‚åœï¼Œå¹¶æŠŠæ§åˆ¶æƒäº¤ç»™è°ƒç”¨è€…ã€‚\n"),a("img",{attrs:{src:"https://img.alicdn.com/tfs/TB1UzXqpsbpK1RjSZFyXXX_qFXa-813-542.svg",alt:"image | left"}}),t._v("\nè°ƒç”¨è€…ä¼šç»§ç»­æ‰§è¡Œï¼Œæœ€ç»ˆè°ƒç”¨æ ˆä¼šæ¸…ç©ºï¼Œç„¶åå¼•æ“ä¼šå¼€å§‹æ‰§è¡Œå¾®ä»»åŠ¡ï¼šè¿è¡Œä¹‹å‰å·²å‡†å¤‡å°±ç»ªçš„ "),a("a",{attrs:{href:"https://tc39.github.io/ecma262/#sec-promiseresolvethenablejob",target:"_blank",rel:"noopener noreferrer"}},[t._v("PromiseResolveThenableJob"),a("OutboundLink")],1),t._v("ï¼Œé¦–å…ˆæ˜¯ä¸€ä¸ª "),a("a",{attrs:{href:"https://tc39.github.io/ecma262/#sec-promisereactionjob",target:"_blank",rel:"noopener noreferrer"}},[t._v("PromiseReactionJob"),a("OutboundLink")],1),t._v("ï¼Œå®ƒçš„å·¥ä½œä»…ä»…æ˜¯åœ¨ä¼ é€’ç»™ "),a("code",[t._v("await")]),t._v(" çš„å€¼ä¸Šå°è£…ä¸€å±‚ "),a("code",[t._v("promise")]),t._v("ã€‚ç„¶åï¼Œå¼•æ“å›åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œå› ä¸ºåœ¨å›åˆ°äº‹ä»¶å¾ªç¯ä¹‹å‰å¾®ä»»åŠ¡é˜Ÿåˆ—å¿…é¡»è¦æ¸…ç©ºã€‚\n"),a("img",{attrs:{src:"https://img.alicdn.com/tfs/TB1goXGpxjaK1RjSZFAXXbdLFXa-813-542.svg",alt:"image | left"}}),t._v("\nç„¶åæ˜¯å¦ä¸€ä¸ª "),a("a",{attrs:{href:"https://tc39.github.io/ecma262/#sec-promisereactionjob",target:"_blank",rel:"noopener noreferrer"}},[t._v("PromiseReactionJob"),a("OutboundLink")],1),t._v("ï¼Œç­‰å¾…æˆ‘ä»¬æ­£åœ¨ "),a("code",[t._v("await")]),t._v("ï¼ˆæˆ‘ä»¬è¿™é‡ŒæŒ‡çš„æ˜¯ "),a("code",[t._v("42")]),t._v("ï¼‰è¿™ä¸ª "),a("code",[t._v("promise")]),t._v(" å®Œæˆï¼Œç„¶åæŠŠè¿™ä¸ªåŠ¨ä½œå®‰æ’åˆ° "),a("code",[t._v("throwaway")]),t._v(" promise é‡Œã€‚å¼•æ“ç»§ç»­å›åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œå› ä¸ºè¿˜æœ‰æœ€åä¸€ä¸ªå¾®ä»»åŠ¡ã€‚\n"),a("img",{attrs:{src:"https://img.alicdn.com/tfs/TB1.44wpAzoK1RjSZFlXXai4VXa-813-542.svg",alt:"image | left"}}),t._v("\nç°åœ¨è¿™ç¬¬äºŒä¸ª "),a("a",{attrs:{href:"https://tc39.github.io/ecma262/#sec-promisereactionjob",target:"_blank",rel:"noopener noreferrer"}},[t._v("PromiseReactionJob"),a("OutboundLink")],1),t._v(" æŠŠå†³å®šä¼ è¾¾ç»™ "),a("code",[t._v("throwaway")]),t._v(" promiseï¼Œå¹¶æ¢å¤ async å‡½æ•°çš„æ‰§è¡Œï¼Œæœ€åè¿”å›ä» "),a("code",[t._v("await")]),t._v(" å¾—åˆ°çš„ "),a("code",[t._v("42")]),t._v("ã€‚\n"),a("img",{attrs:{src:"https://img.alicdn.com/tfs/TB1WrXvpAvoK1RjSZFDXXXY3pXa-957-465.svg",alt:"image | left"}}),t._v("\næ€»ç»“ä¸‹ï¼Œå¯¹äºæ¯ä¸€ä¸ª "),a("code",[t._v("await")]),t._v(" å¼•æ“éƒ½ä¼šåˆ›å»º__ä¸¤ä¸ªé¢å¤–__çš„ promiseï¼ˆå³ä½¿å³å€¼å·²ç»æ˜¯ä¸€ä¸ª promiseï¼‰ï¼Œå¹¶ä¸”éœ€è¦__è‡³å°‘ä¸‰ä¸ª__å¾®ä»»åŠ¡ã€‚è°ä¼šæƒ³åˆ°ä¸€ä¸ªç®€å•çš„ "),a("code",[t._v("await")]),t._v(" ç«Ÿç„¶ä¼šæœ‰å¦‚æ­¤å¤šå†—ä½™çš„è¿ç®—ï¼Ÿï¼\n"),a("img",{attrs:{src:"https://img.alicdn.com/tfs/TB1kLlrpr2pK1RjSZFsXXaNlXXa-451-214.svg",alt:"image | left"}}),t._v("\næˆ‘ä»¬æ¥çœ‹çœ‹åˆ°åº•æ˜¯ä»€ä¹ˆå¼•èµ·å†—ä½™ã€‚ç¬¬ä¸€è¡Œçš„ä½œç”¨æ˜¯å°è£…ä¸€ä¸ª promiseï¼Œç¬¬äºŒè¡Œä¸ºäº† resolve å°è£…åçš„ promose "),a("code",[t._v("await")]),t._v(" ä¹‹åçš„å€¼ "),a("code",[t._v("v")]),t._v("ã€‚è¿™ä¸¤è¡Œäº§ç”Ÿä¸ªå†—ä½™çš„ promise å’Œä¸¤ä¸ªå†—ä½™çš„å¾®ä»»åŠ¡ã€‚å¦‚æœ "),a("code",[t._v("v")]),t._v(" å·²ç»æ˜¯ promise çš„è¯å°±å¾ˆä¸åˆ’ç®—äº†ï¼ˆå¤§å¤šæ—¶å€™ç¡®å®ä¹Ÿæ˜¯å¦‚æ­¤ï¼‰ã€‚åœ¨æŸäº›ç‰¹æ®Šåœºæ™¯ "),a("code",[t._v("await")]),t._v(" äº† "),a("code",[t._v("42")]),t._v(" çš„è¯ï¼Œé‚£ç¡®å®è¿˜æ˜¯éœ€è¦å°è£…æˆ promise çš„ã€‚\nå› æ­¤ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨ "),a("a",{attrs:{href:"https://tc39.github.io/ecma262/#sec-promise-resolve",target:"_blank",rel:"noopener noreferrer"}},[t._v("promiseResolve"),a("OutboundLink")],1),t._v(" æ“ä½œæ¥å¤„ç†ï¼Œåªæœ‰å¿…è¦çš„æ—¶å€™æ‰ä¼šè¿›è¡Œ promise çš„å°è£…ï¼š\n"),a("img",{attrs:{src:"https://img.alicdn.com/tfs/TB1bk0TpyLaK1RjSZFxXXamPFXa-949-376.svg",alt:"image | left"}}),t._v("\nå¦‚æœå…¥å‚æ˜¯ promiseï¼Œåˆ™åŸå°ä¸åŠ¨åœ°è¿”å›ï¼Œåªå°è£…å¿…è¦çš„ promiseã€‚è¿™ä¸ªæ“ä½œåœ¨å€¼å·²ç»æ˜¯ promose çš„æƒ…å†µä¸‹å¯ä»¥çœå»ä¸€ä¸ªé¢å¤–çš„ promise å’Œä¸¤ä¸ªå¾®ä»»åŠ¡ã€‚æ­¤ç‰¹æ€§å¯ä»¥é€šè¿‡ "),a("code",[t._v("--harmony-await-optimization")]),t._v(" å‚æ•°åœ¨ V8ï¼ˆä» v7.1 å¼€å§‹ï¼‰ä¸­å¼€å¯ï¼ŒåŒæ—¶æˆ‘ä»¬ "),a("a",{attrs:{href:"https://github.com/tc39/ecma262/pull/1250",target:"_blank",rel:"noopener noreferrer"}},[t._v("å‘ ECMAScript å‘èµ·äº†ä¸€ä¸ªææ¡ˆ"),a("OutboundLink")],1),t._v("ï¼Œç›®æµ‹å¾ˆå¿«ä¼šåˆå¹¶ã€‚\nä¸‹é¢æ˜¯ç®€åŒ–åçš„ "),a("code",[t._v("await")]),t._v(" æ‰§è¡Œè¿‡ç¨‹ï¼š\n"),a("img",{attrs:{src:"https://img.alicdn.com/tfs/TB1mLNnpCzqK1RjSZPcXXbTepXa-792-545.svg",alt:"image | left"}}),t._v("\næ„Ÿè°¢ç¥å¥‡çš„ "),a("a",{attrs:{href:"https://tc39.github.io/ecma262/#sec-promise-resolve",target:"_blank",rel:"noopener noreferrer"}},[t._v("promiseResolve"),a("OutboundLink")],1),t._v("ï¼Œç°åœ¨æˆ‘ä»¬åªéœ€è¦ä¼  "),a("code",[t._v("v")]),t._v(" å³å¯è€Œä¸ç”¨å…³å¿ƒå®ƒæ˜¯ä»€ä¹ˆã€‚ä¹‹åè·Ÿä¹‹å‰ä¸€æ ·ï¼Œå¼•æ“ä¼šåˆ›å»ºä¸€ä¸ª "),a("code",[t._v("throwaway")]),t._v(" promise å¹¶æ”¾åˆ° "),a("a",{attrs:{href:"https://tc39.github.io/ecma262/#sec-promisereactionjob",target:"_blank",rel:"noopener noreferrer"}},[t._v("PromiseReactionJob"),a("OutboundLink")],1),t._v(" é‡Œä¸ºäº†åœ¨ä¸‹ä¸€ä¸ª tick æ—¶æ¢å¤è¯¥ async å‡½æ•°ï¼Œå®ƒä¼šå…ˆæš‚åœå‡½æ•°ï¼ŒæŠŠè‡ªèº«è¿”å›ç»™æ‰ç”¨è€…ã€‚\n"),a("img",{attrs:{src:"https://img.alicdn.com/tfs/TB1LjtqppYqK1RjSZLeXXbXppXa-648-548.svg",alt:"image | left"}}),t._v("\nå½“æœ€åæ‰€æœ‰æ‰§è¡Œå®Œæ¯•ï¼Œå¼•æ“ä¼šè·‘å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œä¼šæ‰§è¡Œ "),a("a",{attrs:{href:"https://tc39.github.io/ecma262/#sec-promisereactionjob",target:"_blank",rel:"noopener noreferrer"}},[t._v("PromiseReactionJob"),a("OutboundLink")],1),t._v("ã€‚è¿™ä¸ªä»»åŠ¡ä¼šä¼ é€’ "),a("code",[t._v("promise")]),t._v(" ç»“æœç»™ "),a("code",[t._v("throwaway")]),t._v("ï¼Œå¹¶ä¸”æ¢å¤ async å‡½æ•°ï¼Œä» "),a("code",[t._v("await")]),t._v(" æ‹¿åˆ° "),a("code",[t._v("42")]),t._v("ã€‚\n"),a("img",{attrs:{src:"https://img.alicdn.com/tfs/TB11X4rpBLoK1RjSZFuXXXn0XXa-955-383.svg",alt:"image | left"}}),t._v("\nå°½ç®¡æ˜¯å†…éƒ¨ä½¿ç”¨ï¼Œå¼•æ“åˆ›å»º "),a("code",[t._v("throwaway")]),t._v(" promise å¯èƒ½è¿˜æ˜¯ä¼šè®©äººè§‰å¾—å“ªé‡Œä¸å¯¹ã€‚äº‹å®è¯æ˜ï¼Œ"),a("code",[t._v("throwaway")]),t._v(" promise ä»…ä»…æ˜¯ä¸ºäº†æ»¡è¶³è§„èŒƒé‡Œ "),a("code",[t._v("performPromiseThen")]),t._v(" çš„éœ€è¦ã€‚\n"),a("img",{attrs:{src:"https://img.alicdn.com/tfs/TB1P84xpsfpK1RjSZFOXXa6nFXa-936-198.svg",alt:"image | left"}}),t._v("\nè¿™æ˜¯æœ€è¿‘æè®®ç»™ ECMAScript çš„ "),a("a",{attrs:{href:"https://github.com/tc39/ecma262/issues/694",target:"_blank",rel:"noopener noreferrer"}},[t._v("å˜æ›´"),a("OutboundLink")],1),t._v("ï¼Œå¼•æ“å¤§å¤šæ•°æ—¶å€™ä¸å†éœ€è¦åˆ›å»º "),a("code",[t._v("throwaway")]),t._v(" äº†ã€‚\n"),a("img",{attrs:{src:"https://img.alicdn.com/tfs/TB1wYFVpyLaK1RjSZFxXXamPFXa-939-355.svg",alt:"image | left"}}),t._v("\nå¯¹æ¯” "),a("code",[t._v("await")]),t._v(" åœ¨ Node.js 10 å’Œä¼˜åŒ–åï¼ˆåº”è¯¥ä¼šæ”¾åˆ° Node.js 12 ä¸Šï¼‰çš„è¡¨ç°ï¼š\n"),a("img",{attrs:{src:"https://img.alicdn.com/tfs/TB1bBhxprvpK1RjSZPiXXbmwXXa-600-371.svg",alt:"image | left"}}),t._v(" "),t._m(31),a("strong",[t._v("/")]),t._m(32),a("strong",[t._v(" æ€§èƒ½è¶…è¿‡äº†æ‰‹å†™çš„ promise ä»£ç ")]),t._v("ã€‚å…³é”®å°±æ˜¯æˆ‘ä»¬å‡å°‘äº† async å‡½æ•°é‡Œä¸€äº›ä¸å¿…è¦çš„å¼€é”€ï¼Œä¸ä»…ä»…æ˜¯ V8 å¼•æ“ï¼Œå…¶å®ƒ JavaScript å¼•æ“éƒ½é€šè¿‡è¿™ä¸ª "),a("a",{attrs:{href:"https://github.com/tc39/ecma262/pull/1250",target:"_blank",rel:"noopener noreferrer"}},[t._v("è¡¥ä¸"),a("OutboundLink")],1),t._v(" å®ç°äº†ä¼˜åŒ–ã€‚")])]),t._v(" "),t._m(33),t._v(" "),a("p",[t._v("é™¤äº†æ€§èƒ½ï¼ŒJavaScript å¼€å‘è€…ä¹Ÿå¾ˆå…³å¿ƒé—®é¢˜å®šä½å’Œä¿®å¤ï¼Œè¿™åœ¨å¼‚æ­¥ä»£ç é‡Œä¸€ç›´ä¸æ˜¯ä»¶å®¹æ˜“çš„äº‹ã€‚"),a("a",{attrs:{href:"https://developers.google.com/web/tools/chrome-devtools",target:"_blank",rel:"noopener noreferrer"}},[t._v("Chrome DevTools"),a("OutboundLink")],1),t._v(" ç°åœ¨æ”¯æŒäº†å¼‚æ­¥æ ˆè¿½è¸ªï¼š\n"),a("img",{attrs:{src:"https://img.alicdn.com/tfs/TB1gZlwpCzqK1RjSZFHXXb3CpXa-877-369.png",alt:"image | left"}}),t._v("\nåœ¨æœ¬åœ°å¼€å‘æ—¶è¿™æ˜¯ä¸ªå¾ˆæœ‰ç”¨çš„ç‰¹æ€§ï¼Œä¸è¿‡ä¸€æ—¦åº”ç”¨éƒ¨ç½²äº†å°±æ²¡å•¥ç”¨äº†ã€‚è°ƒè¯•æ—¶ï¼Œä½ åªèƒ½çœ‹åˆ°æ—¥å¿—æ–‡ä»¶é‡Œçš„ "),a("code",[t._v("Error#stack")]),t._v(" ä¿¡æ¯ï¼Œè¿™äº›å¹¶ä¸ä¼šåŒ…å«ä»»ä½•å¼‚æ­¥ä¿¡æ¯ã€‚\næœ€è¿‘æˆ‘ä»¬æçš„ "),a("a",{attrs:{href:"https://bit.ly/v8-zero-cost-async-stack-traces",target:"_blank",rel:"noopener noreferrer"}},[t._v("é›¶æˆæœ¬å¼‚æ­¥æ ˆè¿½è¸ª"),a("OutboundLink")],1),t._v(" ä½¿å¾— "),a("code",[t._v("Error#stack")]),t._v(" åŒ…å«äº† async å‡½æ•°çš„è°ƒç”¨ä¿¡æ¯ã€‚ã€Œé›¶æˆæœ¬ã€å¬èµ·æ¥å¾ˆè®©äººå…´å¥‹ï¼Œå¯¹å§ï¼Ÿå½“ Chrome DevTools åŠŸèƒ½å¸¦æ¥é‡å¤§å¼€é”€æ—¶ï¼Œå®ƒå¦‚ä½•æ‰èƒ½å®ç°é›¶æˆæœ¬ï¼Ÿä¸¾ä¸ªä¾‹å­ï¼Œ"),a("code",[t._v("foo")]),t._v(" é‡Œè°ƒç”¨ "),a("code",[t._v("bar")]),t._v("ï¼Œ"),a("code",[t._v("bar")]),t._v(" åœ¨ await ä¸€ä¸ª promise åæŠ›ä¸€ä¸ªå¼‚å¸¸ï¼š")]),t._v(" "),t._m(34),a("p",[t._v("è¿™æ®µä»£ç åœ¨ Node.js 8 æˆ– Node.js 10 è¿è¡Œç»“æœå¦‚ä¸‹ï¼š")]),t._v(" "),t._m(35),t._m(36),t._v(" "),t._m(37),a("p",[t._v("åœ¨æ ˆè¿½è¸ªä¿¡æ¯é‡Œï¼Œæœ€ä¸Šå±‚çš„å‡½æ•°å‡ºç°åœ¨ç¬¬ä¸€ä¸ªï¼Œä¹‹åæ˜¯ä¸€äº›å¼‚æ­¥è°ƒç”¨æ ˆï¼Œå†åé¢æ˜¯ "),a("code",[t._v("foo")]),t._v(" é‡Œé¢ "),a("code",[t._v("bar")]),t._v(" ä¸Šä¸‹æ–‡çš„æ ˆä¿¡æ¯ã€‚è¿™ä¸ªç‰¹æ€§çš„å¯ç”¨å¯ä»¥é€šè¿‡ V8 çš„ "),a("code",[t._v("--async-stack-traces")]),t._v(" å‚æ•°å¯ç”¨ã€‚\nç„¶è€Œï¼Œå¦‚æœä½ è·Ÿä¸Šé¢ Chrome DevTools é‡Œçš„æ ˆä¿¡æ¯å¯¹æ¯”ï¼Œä½ ä¼šå‘ç°æ ˆè¿½è¸ªé‡Œå¼‚æ­¥éƒ¨åˆ†ç¼ºå¤±äº† "),a("code",[t._v("foo")]),t._v(" çš„è°ƒç”¨ç‚¹ä¿¡æ¯ã€‚è¿™é‡Œåˆ©ç”¨äº† "),a("code",[t._v("await")]),t._v(" æ¢å¤å’Œæš‚åœä½ç½®æ˜¯ä¸€æ ·çš„ç‰¹æ€§ï¼Œä½† "),a("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/then",target:"_blank",rel:"noopener noreferrer"}},[t._v("Promise#then()"),a("OutboundLink")],1),t._v(" æˆ– "),a("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/catch",target:"_blank",rel:"noopener noreferrer"}},[t._v("Promise#catch()"),a("OutboundLink")],1),t._v(" å°±ä¸æ˜¯è¿™æ ·çš„ã€‚å¯ä»¥çœ‹ Mathias Bynens çš„æ–‡ç«  "),a("a",{attrs:{href:"https://mathiasbynens.be/notes/async-stack-traces",target:"_blank",rel:"noopener noreferrer"}},[t._v("await beats Promise#then()"),a("OutboundLink")],1),t._v(" äº†è§£æ›´å¤šã€‚")]),t._v(" "),t._m(38),t._v(" "),a("p",[t._v("async å‡½æ•°å˜å¿«å°‘ä¸äº†ä»¥ä¸‹ä¸¤ä¸ªä¼˜åŒ–ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("ç§»é™¤äº†é¢å¤–çš„ä¸¤ä¸ªå¾®ä»»åŠ¡")]),t._v(" "),a("li",[t._v("ç§»é™¤äº† "),a("code",[t._v("throwaway")]),t._v(" promise\né™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬é€šè¿‡ "),a("a",{attrs:{href:"https://bit.ly/v8-zero-cost-async-stack-traces",target:"_blank",rel:"noopener noreferrer"}},[t._v("é›¶æˆæœ¬å¼‚æ­¥æ ˆè¿½è¸ª"),a("OutboundLink")],1),t._v(" æå‡äº† "),a("code",[t._v("await")]),t._v(" å’Œ "),a("code",[t._v("Promise.all()")]),t._v(" å¼€å‘è°ƒè¯•ä½“éªŒã€‚\næˆ‘ä»¬è¿˜æœ‰äº›å¯¹ JavaScript å¼€å‘è€…å‹å¥½çš„æ€§èƒ½å»ºè®®ï¼š\nå¤šä½¿ç”¨ "),a("code",[t._v("async")]),t._v(" å’Œ "),a("code",[t._v("await")]),t._v(" è€Œä¸æ˜¯æ‰‹å†™ promise ä»£ç ï¼Œå¤šä½¿ç”¨ JavaScript å¼•æ“æä¾›çš„ promise è€Œä¸æ˜¯è‡ªå·±å»å®ç°ã€‚")])]),t._v(" "),a("blockquote",[a("p",[t._v("æ–‡ç« å¯éšæ„è½¬è½½ï¼Œä½†è¯·ä¿ç•™æ­¤ "),a("a",{attrs:{href:"https://www.yuque.com/es2049/blog",target:"_blank",rel:"noopener noreferrer"}},[t._v("åŸæ–‡é“¾æ¥"),a("OutboundLink")],1),t._v("ã€‚\néå¸¸æ¬¢è¿æœ‰æ¿€æƒ…çš„ä½ åŠ å…¥ "),a("a",{attrs:{href:"https://es2049.studio/",target:"_blank",rel:"noopener noreferrer"}},[t._v("ES2049 Studio"),a("OutboundLink")],1),t._v("ï¼Œç®€å†è¯·å‘é€è‡³ caijun.hcj(at)"),a("a",{attrs:{href:"http://alibaba-inc.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("alibaba-inc.com"),a("OutboundLink")],1),t._v(" ã€‚")])])])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"promise-optimization"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#promise-optimization","aria-hidden":"true"}},[this._v("#")]),this._v(" Promise Optimization")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"å¼‚æ­¥ç¼–ç¨‹çš„æ–°æ–¹æ¡ˆ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¼‚æ­¥ç¼–ç¨‹çš„æ–°æ–¹æ¡ˆ","aria-hidden":"true"}},[this._v("#")]),this._v(" å¼‚æ­¥ç¼–ç¨‹çš„æ–°æ–¹æ¡ˆ")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"ä»-callbacks-åˆ°-promisesï¼Œå†åˆ°-async-å‡½æ•°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä»-callbacks-åˆ°-promisesï¼Œå†åˆ°-async-å‡½æ•°","aria-hidden":"true"}},[this._v("#")]),this._v(" ä» callbacks åˆ° promisesï¼Œå†åˆ° async å‡½æ•°")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("done"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("validateParams")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("done")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("dbQuery")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dbResults"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("done")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("serviceCall")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dbResults"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" serviceResults"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("done")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" serviceResults"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("validateParams")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dbQuery"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("serviceCall"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("validateParams")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" dbResults "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("dbQuery")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" results "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("serviceCall")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dbResults"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("results"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" results"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"ä»äº‹ä»¶ç›‘å¬å›è°ƒåˆ°-async-è¿­ä»£å™¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä»äº‹ä»¶ç›‘å¬å›è°ƒåˆ°-async-è¿­ä»£å™¨","aria-hidden":"true"}},[this._v("#")]),this._v(" ä»äº‹ä»¶ç›‘å¬å›è°ƒåˆ° async è¿­ä»£å™¨")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nhttp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" body "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setEncoding")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("chunk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    body "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" chunk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'end'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1337")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nhttp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" body "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setEncoding")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" chunk "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("of")]),t._v(" req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      body "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" chunk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("statusCode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1337")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("ä½ å¯ä»¥æŠŠæ‰€æœ‰æ•°æ®å¤„ç†é€»è¾‘éƒ½æ”¾åˆ°ä¸€ä¸ª async å‡½æ•°é‡Œä½¿ç”¨ "),a("code",[t._v("for awaitâ€¦of")]),t._v(" å»è¿­ä»£ chunksï¼Œè€Œä¸æ˜¯åˆ†åˆ«åœ¨ "),a("code",[t._v("'data'")]),t._v(" å’Œ "),a("code",[t._v("'end'")]),t._v(" å›è°ƒé‡Œå¤„ç†ï¼Œè€Œä¸”æˆ‘ä»¬è¿˜åŠ äº† "),a("code",[t._v("try-catch")]),t._v(" å—æ¥é¿å… "),a("code",[t._v("unhandledRejection")]),t._v(" é—®é¢˜ã€‚\nä»¥ä¸Šè¿™äº›ç‰¹æ€§ä½ ä»Šå¤©å°±å¯ä»¥åœ¨ç”Ÿæˆç¯å¢ƒä½¿ç”¨ï¼async å‡½æ•°__ä» Node.js 8 (V8 v6.2 / Chrome 62) å¼€å§‹å°±å·²å…¨é¢æ”¯æŒ__ï¼Œasync è¿­ä»£å™¨__ä» Node.js 10 (V8 v6.8 / Chrome 68) å¼€å§‹æ”¯æŒ__ã€‚")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"async-æ€§èƒ½ä¼˜åŒ–"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#async-æ€§èƒ½ä¼˜åŒ–","aria-hidden":"true"}},[this._v("#")]),this._v(" async æ€§èƒ½ä¼˜åŒ–")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" p "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Promise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" p"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'after:await'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\np"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'tick:a'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'tick:b'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("ä¸Šé¢ä»£ç ä¸€å¼€å§‹åˆ›å»ºäº†ä¸€ä¸ªå·²ç»å®ŒæˆçŠ¶æ€çš„ promise "),a("code",[t._v("p")]),t._v("ï¼Œç„¶å "),a("code",[t._v("await")]),t._v(" å‡ºå…¶ç»“æœï¼ŒåˆåŒæ—¶é“¾äº†ä¸¤ä¸ª "),a("code",[t._v("then")]),t._v("ï¼Œé‚£æœ€ç»ˆçš„ "),a("code",[t._v("console.log")]),t._v(" æ‰“å°çš„ç»“æœä¼šæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ\nå› ä¸º "),a("code",[t._v("p")]),t._v(" æ˜¯å·²å®Œæˆçš„ï¼Œä½ å¯èƒ½è®¤ä¸ºå…¶ä¼šå…ˆæ‰“å° "),a("code",[t._v("'after:await'")]),t._v("ï¼Œç„¶åæ˜¯å‰©ä¸‹ä¸¤ä¸ª "),a("code",[t._v("tick")]),t._v(", äº‹å®ä¸Š Node.js 8 é‡Œçš„ç»“æœæ˜¯ï¼š\n"),a("img",{attrs:{src:"https://img.alicdn.com/tfs/TB1H_FhpCzqK1RjSZPcXXbTepXa-959-445.svg",alt:"image | left"}}),t._v("\nè™½ç„¶ä»¥ä¸Šç»“æœç¬¦åˆé¢„æœŸï¼Œä½†æ˜¯å´ä¸ç¬¦åˆè§„èŒƒã€‚Node.js 10 çº æ­£äº†è¿™ä¸ªè¡Œä¸ºï¼Œä¼šå…ˆæ‰§è¡Œ "),a("code",[t._v("then")]),t._v(" é“¾é‡Œçš„ï¼Œç„¶åæ‰æ˜¯ async å‡½æ•°ã€‚\n"),a("img",{attrs:{src:"https://img.alicdn.com/tfs/TB1OthqpAvoK1RjSZFNXXcxMVXa-959-445.svg",alt:"image | left"}}),t._v("\nè¿™ä¸ªã€Œæ­£ç¡®çš„è¡Œä¸ºã€çœ‹èµ·æ¥å¹¶ä¸æ­£å¸¸ï¼Œç”šè‡³ä¼šè®©å¾ˆå¤š JavaScript å¼€å‘è€…æ„Ÿåˆ°åƒæƒŠï¼Œè¿˜æ˜¯æœ‰å¿…è¦å†è¯¦ç»†è§£é‡Šä¸‹ã€‚åœ¨è§£é‡Šä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆä»ä¸€äº›åŸºç¡€å¼€å§‹ã€‚")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"ä»»åŠ¡ï¼ˆtasksï¼‰vs-å¾®ä»»åŠ¡ï¼ˆmicrotasksï¼‰"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä»»åŠ¡ï¼ˆtasksï¼‰vs-å¾®ä»»åŠ¡ï¼ˆmicrotasksï¼‰","aria-hidden":"true"}},[this._v("#")]),this._v(" ä»»åŠ¡ï¼ˆtasksï¼‰vs. å¾®ä»»åŠ¡ï¼ˆmicrotasksï¼‰")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"async-å‡½æ•°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#async-å‡½æ•°","aria-hidden":"true"}},[this._v("#")]),this._v(" async å‡½æ•°")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("computeAnswer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("42")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" p "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("computeAnswer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// â†’ Promise")]),t._v("\np"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// prints 42 on the next turn")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("ä½ åªèƒ½åœ¨ä¸‹ä¸€ä¸ªå¾®ä»»åŠ¡æ‰§è¡Œåæ‰èƒ½å¾—åˆ° promise "),s("code",[this._v("p")]),this._v(" è¿”å›çš„å€¼ï¼Œæ¢å¥è¯è¯´ï¼Œä¸Šé¢çš„ä»£ç è¯­ä¹‰ä¸Šç­‰ä»·äºä½¿ç”¨ "),s("code",[this._v("Promise.resolve")]),this._v(" å¾—åˆ°çš„ç»“æœï¼š")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("computeAnswer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Promise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("42")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("async å‡½æ•°çœŸæ­£å¼ºå¤§çš„åœ°æ–¹æ¥æºäº "),s("code",[this._v("await")]),this._v(" è¡¨è¾¾å¼ï¼Œå®ƒå¯ä»¥è®©ä¸€ä¸ªå‡½æ•°æ‰§è¡Œæš‚åœç›´åˆ°ä¸€ä¸ª promise å·²æ¥å—ï¼ˆresolvedï¼‰ï¼Œç„¶åç­‰åˆ°å·²å®Œæˆï¼ˆfulfilledï¼‰åæ¢å¤æ‰§è¡Œã€‚å·²å®Œæˆçš„ promise ä¼šä½œä¸º "),s("code",[this._v("await")]),this._v(" çš„å€¼ã€‚è¿™é‡Œçš„ä¾‹å­ä¼šè§£é‡Šè¿™ä¸ªè¡Œä¸ºï¼š")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetchStatus")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" response "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[a("code",[t._v("fetchStatus")]),t._v(" åœ¨é‡åˆ° "),a("code",[t._v("await")]),t._v(" æ—¶ä¼šæš‚åœï¼Œå½“ "),a("code",[t._v("fetch")]),t._v(" è¿™ä¸ª promise å·²å®Œæˆåä¼šæ¢å¤æ‰§è¡Œï¼Œè¿™è·Ÿç›´æ¥é“¾å¼å¤„ç† "),a("code",[t._v("fetch")]),t._v(" è¿”å›çš„ promise æŸç§ç¨‹åº¦ä¸Šç­‰ä»·ã€‚")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetchStatus")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("response "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("é“¾å¼å¤„ç†å‡½æ•°é‡ŒåŒ…å«äº†ä¹‹å‰è·Ÿåœ¨ "),a("code",[t._v("await")]),t._v(" åé¢çš„ä»£ç ã€‚\næ­£å¸¸æ¥è¯´ä½ åº”è¯¥åœ¨ "),a("code",[t._v("await")]),t._v(" åé¢æ”¾ä¸€ä¸ª "),a("code",[t._v("Promise")]),t._v("ï¼Œä¸è¿‡å…¶å®åé¢å¯ä»¥è·Ÿä»»æ„ JavaScript çš„å€¼ï¼Œå¦‚æœè·Ÿçš„ä¸æ˜¯ promiseï¼Œä¼šè¢«åˆ¶è½¬ä¸º promiseï¼Œæ‰€ä»¥ "),a("code",[t._v("await 42")]),t._v(" æ•ˆæœå¦‚ä¸‹ï¼š")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("foo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" v "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("42")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" v"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" p "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("foo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// â†’ Promise")]),t._v("\np"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// prints `42` eventually")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Sleep")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("timeout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("timeout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" timeout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("resolve"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" startTime "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" startTime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n               "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("timeout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" actualTime "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Sleep")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("actualTime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("foo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" w "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" v"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" w"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("æ‰§è¡Œæ—¶ï¼Œå®ƒæŠŠå‚æ•° "),s("code",[this._v("v")]),this._v(" å°è£…æˆä¸€ä¸ª promiseï¼Œç„¶åä¼šæš‚åœç›´åˆ° promise å®Œæˆï¼Œç„¶å "),s("code",[this._v("w")]),this._v(" èµ‹å€¼ä¸ºå·²å®Œæˆçš„ promiseï¼Œæœ€å async è¿”å›äº†è¿™ä¸ªå€¼ã€‚")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"ç¥ç§˜çš„-await"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç¥ç§˜çš„-await","aria-hidden":"true"}},[this._v("#")]),this._v(" ç¥ç§˜çš„ "),s("code",[this._v("await")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("é¦–å…ˆï¼ŒV8 ä¼šæŠŠè¿™ä¸ªå‡½æ•°æ ‡è®°ä¸ºå¯æ¢å¤çš„ï¼Œæ„å‘³ç€æ‰§è¡Œå¯ä»¥è¢«æš‚åœå¹¶æ¢å¤ï¼ˆä» "),a("code",[t._v("await")]),t._v(" è§’åº¦çœ‹æ˜¯è¿™æ ·çš„ï¼‰ã€‚ç„¶åï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ‰€è°“çš„ "),a("code",[t._v("implicit_promise")]),t._v("ï¼ˆç”¨äºæŠŠ async å‡½æ•°é‡Œäº§ç”Ÿçš„å€¼è½¬ä¸º promiseï¼‰ã€‚\n"),a("img",{attrs:{src:"https://img.alicdn.com/tfs/TB1knFmpCzqK1RjSZFLXXcn2XXa-960-469.svg",alt:"image | left"}}),t._v("\nç„¶åæ˜¯æœ‰æ„æ€çš„ä¸œè¥¿æ¥äº†ï¼šçœŸæ­£çš„ "),a("code",[t._v("await")]),t._v("ã€‚é¦–å…ˆï¼Œè·Ÿåœ¨ "),a("code",[t._v("await")]),t._v(" åé¢çš„å€¼è¢«è½¬ä¸º promiseã€‚ç„¶åï¼Œå¤„ç†å‡½æ•°ä¼šç»‘å®šè¿™ä¸ª promise ç”¨äºåœ¨ promise å®Œæˆåæ¢å¤ä¸»å‡½æ•°ï¼Œæ­¤æ—¶ async å‡½æ•°è¢«æš‚åœäº†ï¼Œè¿”å› "),a("code",[t._v("implicit_promise")]),t._v(" ç»™è°ƒç”¨è€…ã€‚ä¸€æ—¦ "),a("code",[t._v("promise")]),t._v(" å®Œæˆäº†ï¼Œå‡½æ•°ä¼šæ¢å¤å¹¶æ‹¿åˆ°ä» "),a("code",[t._v("promise")]),t._v(" å¾—åˆ°å€¼ "),a("code",[t._v("w")]),t._v("ï¼Œæœ€åï¼Œ"),a("code",[t._v("implicit_promise")]),t._v(" ä¼šç”¨ "),a("code",[t._v("w")]),t._v(" æ ‡è®°ä¸ºå·²æ¥å—ã€‚\nç®€å•è¯´ï¼Œ"),a("code",[t._v("await v")]),t._v(" åˆå§‹åŒ–æ­¥éª¤æœ‰ä»¥ä¸‹ç»„æˆï¼š")])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[this._v("æŠŠ "),s("code",[this._v("v")]),this._v(" è½¬æˆä¸€ä¸ª promiseï¼ˆè·Ÿåœ¨ "),s("code",[this._v("await")]),this._v(" åé¢çš„ï¼‰ã€‚")])},function(){var t=this.$createElement,s=this._self._c||t;return s("strong",[s("code",[this._v("async")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("strong",[s("code",[this._v("await")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"å¼€å‘ä½“éªŒä¼˜åŒ–"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¼€å‘ä½“éªŒä¼˜åŒ–","aria-hidden":"true"}},[this._v("#")]),this._v(" å¼€å‘ä½“éªŒä¼˜åŒ–")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("foo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("42")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" Promise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'BEEP BEEP'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("foo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ node index.js\nError: BEEP BEEP\n    at bar "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("index.js:8:9"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at process._tickCallback "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("internal/process/next_tick.js:68:7"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at Function.Module.runMain "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("internal/modules/cjs/loader.js:745:11"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at startup "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("internal/bootstrap/node.js:266:19"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at bootstrapNodeJSCore "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("internal/bootstrap/node.js:595:3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("æ³¨æ„åˆ°ï¼Œå°½ç®¡æ˜¯ "),a("code",[t._v("foo()")]),t._v(" é‡Œçš„è°ƒç”¨æŠ›çš„é”™ï¼Œ"),a("code",[t._v("foo")]),t._v(" æœ¬èº«å´ä¸åœ¨æ ˆè¿½è¸ªä¿¡æ¯é‡Œã€‚å¦‚æœåº”ç”¨æ˜¯éƒ¨ç½²åœ¨äº‘å®¹å™¨é‡Œï¼Œè¿™ä¼šè®©å¼€å‘è€…å¾ˆéš¾å»å®šä½é—®é¢˜ã€‚\næœ‰æ„æ€çš„æ˜¯ï¼Œå¼•æ“æ˜¯çŸ¥é“ "),a("code",[t._v("bar")]),t._v(" ç»“æŸååº”è¯¥ç»§ç»­æ‰§è¡Œä»€ä¹ˆçš„ï¼šå³ "),a("code",[t._v("foo")]),t._v(" å‡½æ•°é‡Œ "),a("code",[t._v("await")]),t._v(" åã€‚æ°å¥½ï¼Œè¿™é‡Œä¹Ÿæ­£æ˜¯ "),a("code",[t._v("foo")]),t._v(" æš‚åœçš„åœ°æ–¹ã€‚å¼•æ“å¯ä»¥åˆ©ç”¨è¿™äº›ä¿¡æ¯é‡å»ºå¼‚æ­¥çš„æ ˆè¿½è¸ªä¿¡æ¯ã€‚æœ‰äº†ä»¥ä¸Šä¼˜åŒ–ï¼Œè¾“å‡ºå°±ä¼šå˜æˆè¿™æ ·ï¼š")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ node --async-stack-traces index.js\nError: BEEP BEEP\n    at bar "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("index.js:8:9"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at process._tickCallback "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("internal/process/next_tick.js:68:7"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at Function.Module.runMain "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("internal/modules/cjs/loader.js:745:11"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at startup "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("internal/bootstrap/node.js:266:19"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at bootstrapNodeJSCore "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("internal/bootstrap/node.js:595:3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    at async foo "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("index.js:2:3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"ç»“è®º"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç»“è®º","aria-hidden":"true"}},[this._v("#")]),this._v(" ç»“è®º")])}],!1,null,null,null);s.default=e.exports}}]);